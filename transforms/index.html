<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Transforms - LSFB Dataset</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Transforms";
    var mkdocs_page_input_path = "transforms.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> LSFB Dataset</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../lsfb_isol/">LSFB Isol</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../lsfb_cont/">LSFB Cont</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../visualisation/">Visualisation</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Transforms</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#how-to-use-transforms">How to Use Transforms</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#available-transforms">Available Transforms</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#i3dpixelsvalue">I3DPixelsValue</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#changevideoshape">ChangeVideoShape</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#resizevideo">ResizeVideo</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#randomcropvideo">RandomCropVideo</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#centercropvideo">CenterCropVideo</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#trimvideo">TrimVideo</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#randomtrimvideo">RandomTrimVideo</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#padvideo">PadVideo</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">LSFB Dataset</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Transforms</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="transforms">Transforms</h1>
<p>The transforms class are inspired from the <a href="https://pytorch.org/docs/stable/torchvision/transforms.html">TorchVision transforms</a> workflow. Unfortunately, torchvision does not (yet) provides transforms for video. To help you to easily build your own pre-processing or data augmentation workflow we created several extension of torchvision transforms for video.</p>
<h2 id="how-to-use-transforms">How to Use Transforms</h2>
<p>The transfoms must be imported and could be chain as you like :</p>
<pre><code class="language-python">from torchvision import transforms
from lsfb_dataset.transforms.video_transforms import (
    ChangeVideoShape,
    ResizeVideo,
    RandomCropVideo,
    CenterCropVideo,
    I3DPixelsValue,
    RandomTrimVideo,
    TrimVideo,
    PadVideo,
)
from lsfb_dataset.datasets.lsfb_dataset import LsfbDataset


composed_train = transforms.Compose(
    [
        RandomTrimVideo(nbr_frames),
        PadVideo(nbr_frames),
        ResizeVideo(270, interpolation=&quot;linear&quot;),
        RandomCropVideo((224, 224)),
        I3DPixelsValue(),
        ChangeVideoShape(&quot;CTHW&quot;),
    ]
)

train_dataset = LsfbDataset(train_split, transforms=composed_train, max_frame = 100)

</code></pre>
<h2 id="available-transforms">Available Transforms</h2>
<h3 id="i3dpixelsvalue">I3DPixelsValue</h3>
<p>By default, the dataloader normalize the pixel value between 0 and 1. This transformation will change that to normalize the pixels value between -1 and 1 like in the I3D paper.</p>
<h3 id="changevideoshape">ChangeVideoShape</h3>
<p>Expect to receive tha video in the shape (Time, Height, Width, Channels) which is the default format of cv2 or PIL and change this shape to either channel first CTHW (Channels, Time, Height, Width) or time first TCHW format.</p>
<h3 id="resizevideo">ResizeVideo</h3>
<p>Resize a video in shape (T, H, W, C) to the desired size.</p>
<h3 id="randomcropvideo">RandomCropVideo</h3>
<p>Crop randomly a video in shape (T, H, W, C) to the desired size.</p>
<h3 id="centercropvideo">CenterCropVideo</h3>
<p>Crop a video in shape (T, H, W, C) at its center.</p>
<h3 id="trimvideo">TrimVideo</h3>
<p>Reduce the length of the video to the desired number of frames. </p>
<h3 id="randomtrimvideo">RandomTrimVideo</h3>
<p>Trim randomly the video to the desired length. This could be use as a type of data augmentation</p>
<h3 id="padvideo">PadVideo</h3>
<p>Pad the video to the desired length. The padding could eather be made by looping the video or by adding zero frame at the end.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../visualisation/" class="btn btn-neutral" title="Visualisation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../visualisation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
